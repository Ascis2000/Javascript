
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Películas</title>
    <style>

    body {
        margin: 20px;
        font-family: Arial, sans-serif;
    }

    .boxTitulo {
        padding: 8px;
        text-align: left;
        font-size: 1.5em;
        margin-bottom: 10px;

        border-radius: 5px;
        border: 1px solid #bbbdc6;
        box-shadow: rgba(50, 50, 93, 0.25) 
            0px 2px 5px -1px, 
            rgba(0, 0, 0, 0.3) 
            0px 1px 3px -1px;

        background: rgb(230,238,242);
        background: linear-gradient(180deg, rgba(230,238,242,1) 0%, rgba(95,157,189,1) 100%);
    }

    /* estilos anidados para .boxTable */
    .boxTable {
        height: 250px;
        overflow-y: auto;
        border-radius: 2px;
        border: 1px solid rgb(146, 164, 203);
        position: relative;
        box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;

        table {
            width: 100%;
            color: #333333;
            margin: 0px 0px 1px 0px;
            border-collapse: collapse;
        }
        thead {
            top: 0;
            z-index: 10;
            position: sticky;
            background-color: #c3d0e2;
            box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;
        }
        th {
            padding: 8px;
            cursor: pointer;
            text-align: left;
            color:rgb(23, 59, 114);
        }
        th:first-child {
            width: 30px;
            text-align: center;
        }
        th:not(:first-child) {
            border-left: 1px solid #b2bbd4;
        }
        th:not(:last-child) {
            border-right: 1px solid #b2bbd4;
        }

        td {
            padding: 8px;
            text-align: left;
            border: 0px solid #bbbdc6;
        }
        td:first-child {
            color: #777777;
            text-align: center;
        }
        td:not(:first-child) {
            border-left: 1px solid #b2bbd4;
        }
        td:not(:last-child) {
            border-right: 1px solid #b2bbd4;
        }

        /* Estilo para las celdas en filas pares */
        tr:nth-child(even) td {
            background-color: #edf3f5;
        }
        /* Estilo para las celdas en filas impares */
        tr:nth-child(odd) td {
            background-color: #ffffff;
        }

        td span {
            cursor: pointer;
            color: rgb(81, 159, 199)
        }
        td span:hover {
            cursor: pointer;
            color: rgb(31, 48, 124)
        }
    }

    .director-info {
        display: none;
        position: absolute;
        top: 20px;
        left: 20px;
        border: 1px solid #ccc;
        background: #fff;
        padding: 10px;
    }

    </style>

    <script>
    
    // variables globales
    let tabla;
    let tbody;
    let ths;

    // ejecutamos las funciones de inicio cuando ya se ha cargado toda la página
    document.addEventListener('DOMContentLoaded', function() {
        set_tabla('tblPeliculas'); // definimos la tabla
        renderiza_tBody(); // pintamos los datos en el tbody
        set_eventos_tabla(); // asignamos los eventos de toa la tabla
    });

    </script>
</head>

<body>

<div class="boxTitulo">Películas</div>
<div class="boxTable">
    <table id="tblPeliculas">
    <thead>
        <tr>
            <th>#</th>
            <th data-th="titulo">
                <span>Película</span>
                <span class="icon">&#9650;</span>
            </th>
            <th data-th="director">
                <span>Director</span>
                <span class="icon">&#9650;</span>
            </th>
            <th data-th="anio">
                <span>Año</span>
                <span class="icon">&#9650;</span>
            </th>
        </tr>
    </thead>

    <tbody>
    </tbody>
    </table>
</div>

<div id="director-info" class="director-info" style="z-index: 11;">
    <h3>Películas del director</h3>
    <ul id="director-films">
        <!-- Películas del director se insertarán aquí -->
    </ul>
    <button onclick="closeDirectorInfo()">Cerrar</button>
</div>

<script>
        
// array de directores
const arr_directores = [
    { id: 'alHitchcock', nombre: 'Alfred Hitchcock' },
    { id: 'chNolan', nombre: 'Christopher Nolan' },
    { id: 'frFoCoppola', nombre: 'Francis Ford Coppola' },
    { id: 'guDelToro', nombre: 'Guillermo del Toro' },
    { id: 'jaCameron', nombre: 'James Cameron' },
    { id: 'joCoen', nombre: 'Joel Coen' },
    { id: 'laWachowski', nombre: 'Lana Wachowski' },
    { id: 'liWachowski', nombre: 'Lilly Wachowski' },
    { id: 'maScorsese', nombre: 'Martin Scorsese' },
    { id: 'peJackson', nombre: 'Peter Jackson' },
    { id: 'quTarantino', nombre: 'Quentin Tarantino' },
    { id: 'riDonner', nombre: 'Richard Donner' },
    { id: 'riScott', nombre: 'Ridley Scott' },
    { id: 'roZemeckis', nombre: 'Robert Zemeckis' },
    { id: 'stKubrick', nombre: 'Stanley Kubrick' },
    { id: 'stSpielberg', nombre: 'Steven Spielberg' }
];

// array de interpretes
const arr_interpretes = [
    { id: 'alPacino', nombre: 'Al Pacino' },
    { id: 'anHathaway', nombre: 'Anne Hathaway' },
    { id: 'arSchwarzenegger', nombre: 'Arnold Schwarzenegger' },
    { id: 'brPitt', nombre: 'Brad Pitt' },
    { id: 'caAnMoss', nombre: 'Carrie-Anne Moss' },
    { id: 'chBale', nombre: 'Christian Bale' },
    { id: 'chHemsworth', nombre: 'Chris Hemsworth' },
    { id: 'chReeve', nombre: 'Christopher Reeve' },
    { id: 'daGlover', nombre: 'Danny Glover' },
    { id: 'emStone', nombre: 'Emma Stone' },
    { id: 'emWatson', nombre: 'Emma Watson' },
    { id: 'gaSinise', nombre: 'Gary Sinise' },
    { id: 'heLedger', nombre: 'Heath Ledger' },
    { id: 'jeLawrence', nombre: 'Jennifer Lawrence' },
    { id: 'joTravolta', nombre: 'John Travolta' },
    { id: 'juLaw', nombre: 'Jude Law' },
    { id: 'keReeves', nombre: 'Keanu Reeves' },
    { id: 'leDiCaprio', nombre: 'Leonardo DiCaprio' },
    { id: 'liNeeson', nombre: 'Liam Neeson' },
    { id: 'liHamilton', nombre: 'Linda Hamilton' },
    { id: 'maMcDowell', nombre: 'Malcolm McDowell' },
    { id: 'maBrando', nombre: 'Marlon Brando' },
    { id: 'maMcConaughey', nombre: 'Matthew McConaughey' },
    { id: 'meGibson', nombre: 'Mel Gibson' },
    { id: 'meStreep', nombre: 'Meryl Streep' },
    { id: 'moFreeman', nombre: 'Morgan Freeman' },
    { id: 'naPortman', nombre: 'Natalie Portman' },
    { id: 'paMagee', nombre: 'Patrick Magee' },
    { id: 'roDowneyJr', nombre: 'Robert Downey Jr.' },
    { id: 'scJohansson', nombre: 'Scarlett Johansson' },
    { id: 'siWeaver', nombre: 'Sigourney Weaver' },
    { id: 'tiRoth', nombre: 'Tim Roth' },
    { id: 'toCruise', nombre: 'Tom Cruise' },
    { id: 'toHanks', nombre: 'Tom Hanks' },
    { id: 'toSkerritt', nombre: 'Tom Skerritt' },
    { id: 'viDavis', nombre: 'Viola Davis' },
    { id: 'wiSmith', nombre: 'Will Smith' }
];

// array de generos
const arr_generos = [
    { id: 'accion', nombre: 'Acción' },
    { id: 'aventuras', nombre: 'Aventuras' },
    { id: 'belica', nombre: 'Bélica' },
    { id: 'biografica', nombre: 'Biográfica' },
    { id: 'ciFiccion', nombre: 'Ciencia Ficción' },
    { id: 'ciNegro', nombre: 'Cine Negro' },
    { id: 'crimen', nombre: 'Crimen' },
    { id: 'comedia', nombre: 'Comedia' },
    { id: 'drama', nombre: 'Drama' },
    { id: 'fantasia', nombre: 'Fantasía' },
    { id: 'gansteres', nombre: 'Gánsteres' },
    { id: 'historica', nombre: 'Histórica' },
    { id: 'horror', nombre: 'Horror' },
    { id: 'misterio', nombre: 'Misterio' },
    { id: 'musical', nombre: 'Musical' },
    { id: 'romance', nombre: 'Romance' },
    { id: 'terror', nombre: 'Terror' },
    { id: 'thriller', nombre: 'Thriller' },
    { id: 'western', nombre: 'Western' }
]

// array de peliculas
const arr_peliculas = [
    { 
        titulo: 'Alien', 
        director: 'riScott', 
        interpretes: ['siWeaver', 'toSkerritt'], 
        genero: ['ciFiccion', 'terror'],
        anio: 1979 
    },
    { 
        titulo: 'El Padrino', 
        director: 'frFoCoppola', 
        interpretes: ['alPacino', 'maBrando'], 
        genero: ['drama', 'crimen', 'gansteres'],
        anio: 1972 
    },
    { 
        titulo: 'La Lista de Schindler', 
        director: 'stSpielberg', 
        interpretes: ['liNeeson'], 
        genero: ['belica', 'biografica', 'drama'],
        anio: 1993 
    },
    { 
        titulo: 'La Naranja Mecánica', 
        director: 'stKubrick', 
        interpretes: ['maMcDowell', 'paMagee'], 
        anio: 1971 
    },
    { 
        titulo: 'Pulp Fiction', 
        director: 'quTarantino', 
        interpretes: ['joTravolta', 'tiRoth'], 
        anio: 1994 
    },
    { 
        titulo: 'El Caballero Oscuro', 
        director: 'chNolan', 
        interpretes: ['chBale', 'heLedger'], 
        anio: 2008 
    },
    { 
        titulo: 'Forrest Gump', 
        director: 'roZemeckis', 
        interpretes: ['toHanks', 'gaSinise'], 
        anio: 1994 
    },
    { 
        titulo: 'Interstellar', 
        director: 'chNolan', 
        interpretes: ['maMcConaughey', 'anHathaway'], 
        anio: 2014 
    },
    { 
        titulo: 'Matrix', 
        director: ['laWachowski', 'liWachowski'], 
        interpretes: ['keReeves', 'caAnMoss'], 
        anio: 1999 
    },
    { 
        titulo: 'Terminator', 
        director: 'jaCameron', 
        interpretes: ['arSchwarzenegger', 'liHamilton'], 
        anio: 1984 
    }
];

// Ejemplo de acceso
/* 
const peliculaEjemplo = peliculas[0];
const director = arr_directores[peliculaEjemplo.director];
const actores = peliculaEjemplo.interpretes.map(id => interpretes[id]);
const generosPeliculas = peliculaEjemplo.generos.map(id => generos[id]);

console.log('Película:', peliculaEjemplo.titulo);
console.log('Director:', director.nombre);
console.log('Actores:', actores.map(actor => actor.nombre).join(', '));
console.log('Géneros:', generosPeliculas.map(genero => genero.nombre).join(', ')); 
*/

function set_tabla(tbl){

    // asignamos valores a las variables globales de tabla
    tabla = document.getElementById(tbl);
    tbody = tabla.querySelector('tbody');
    ths = tabla.querySelectorAll('th');
}

function renderiza_tBody() {

    let html = "";
    let director;

    arr_peliculas.forEach((p, index) => {

        director = get_director_HTML(p.director);

        html += `
            <tr>
                <td>${index + 1}</td>
                <td>${p.titulo}</td>
                <td>${director}</td>
                <td>${p.anio}</td>
            </tr>
        `;
    });
    tbody.innerHTML = html;
}

function get_director_HTML(directores) {

    //concat: convertimos cualquier valor de 'directores' en un array
    return [].concat(directores).map(dir_id => {

        // obtenemos el identificador de director
        const director = arr_directores.find(d => {
            return (d.id === dir_id);
        });
        return `
            <span 
                data-director="${director.id}">
                ${director.nombre}
            </span>`;
    }).join(", ");
}

function set_eventos_tabla() {

    // array de elementos que contengan el atributo 'data-director'
    const arr_data_directors = document.querySelectorAll('[data-director]');

    arr_data_directors.forEach(dt_director => {
        dt_director.addEventListener('click', (e) => {
            e.preventDefault(); // funcionalidad si fuese una etiqueta '<a>'
            
            const data_director = dt_director.getAttribute('data-director');
            mostrarPeliculasDirector(data_director);
        });
    });
}

function mostrarPeliculasDirector(nombreDirector) {
    const directorInfo = document.getElementById('director-info');
    const directorFilms = document.getElementById('director-films');
    directorFilms.innerHTML = '';

    const director = arr_directores.find(d => d.id === nombreDirector);
    if (director) {
        const peliculasDelDirector = arr_peliculas.filter(pelicula => Array.isArray(pelicula.director) ? pelicula.director.includes(director.id) : pelicula.director === director.id);
        peliculasDelDirector.forEach(pelicula => {
            const li = document.createElement('li');
            li.textContent = pelicula.titulo;
            directorFilms.appendChild(li);
        });
    } else {
        const li = document.createElement('li');
        li.textContent = 'No se encontraron películas para este director';
        directorFilms.appendChild(li);
    }

    directorInfo.style.display = 'block';
}

        function closeDirectorInfo() {
            document.getElementById('director-info').style.display = 'none';
        }

    </script>
</body>
</html>